<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Function _FileCopyDlg</title>
<link href="default.css" rel="stylesheet" type="text/css"
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">_FileCopyDlg</font>
<hr size="2" />
<p>Copys a file, multiple files, or directory to the specified destination.<br /></p>

<p class="codeheader">
_FileCopyDlg ( source, dest[, flags] )<br />
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
	<tr>
		<td width="15%">source</td>
		<td width="85%">Full path to a file or directory.  Wildcards are supported. A list of individual file paths or
directories can be specifed by seperating each path with @LF.</td>
	</tr>
	<tr>
		<td width="15%">dest</td>
		<td width="85%">The destination directory.  By default, if the target destination does not exist, 
		it will be created.</td>
	</tr>
	<tr>
		<td width="15%">flags</td>
		<td widht="85%">Supports one or more of the following optional flags (see <a href="File Operation Constants.html">Flags</a> for definitions):<br />
		$FOF_ALLOWUNDO<br />
		$FOF_FILESONLY<br />
		$FOF_MULTIDESTFILES<br />
        $FOF_NOCONFIRMATION<br />
		$FOF_NOCONFIRMMKDIR<br />
		$FOF_NOCOPYSECURITYATTRIBS<br />
		$FOF_NOERRORUI<br />
		$FOF_NORECURSION<br />
		$FOF_RENAMEONCOLLISION<br />
		$FOF_SILENT<br />
		$FOF_SIMPLEPROGRESS<br />
		$FOF_WANTMAPPINGHANDLE   (requires $FOF_RENAMECOLLISION)<br />
		$FOF_NO_CONNECTED_ELEMENTS (requires IE5 or higher)<br />
		$FOF_WANTNUKEWARNING (requires IE5 or higher)<br />
		$FOF_NORECURSEPARSE<br />
	</tr>
</table>

<p>&nbsp;</p>

<p><b>Return Value</b></p>
<b>Success</b> - True.<br />
<b>Failure</b> - False. Raises error message dialogs for the following errors:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- source not defined or does not exist.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- dest not defined.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Could not create SHFILEOPTSTRUCT structure.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Dll call failed and was unable to retrieve error info using GetLastError call, otherwise sets @error to the value returned by GetLastError.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Operation aborted.<br />
<p>&nbsp;</p>

<p><b>Remarks</b></p>
Modified from original code by Livewire (see <a href="http://www.autoitscript.com/forum/index.php">AutoIt Forum</a>).<br />
<br />
<p>&nbsp;</p>

<p><b>Related</b></p>
<a href="_FileMoveDlg.html">_FileMoveDlg</a>,&nbsp;<a href="_FileRenameDlg.html">_FileRenameDlg</a>,&nbsp;<a href="_FileDeleteDlg.html">_FileDeleteDlg</a>
<p>&nbsp;</p>

<p><b>Example</b></p>
<p class="codebox">
<br />
<span><span class="syntax">#include</span><span class="space"> </span><span class="string">"FileLib.au3"</span><br /><br />
<span class="comment">;Copy a single file to a directory.</span><br />
<span class="syntax">If</span><span class="space"> </span><span class="method">_FileCopyDlg</span><span class="operator">(</span><span class="string">"C:\myfile.txt"</span><span class="operator">,</span><span class="space"> </span><span class="string">"C:\temp\"</span><span class="operator">)</span><span class="space"> </span><span class="operator">=</span><span class="space"> </span><span class="syntax">False Then</span>
<br />
<span class="space">&nbsp;&nbsp;&nbsp;</span><span class="syntax">MsgBox</span><span class="operator">(</span><span class="number">16</span><span class="operator">,</span><span class="space"> </span><span class="string">"Error"</span><span class="operator">,</span><span class="space"> </span><span class="string">"Failed to copy file."</span><span class="operator">)</span>
<br />
<span class="syntax">EndIf</span><br /><br />
<span class="comment">;Copy a directory and all sudirectories to another directory and warn before overwrite.</span><br />
<span class="method">_FileCopyDlg</span><span class="operator">(</span><span class="string">"C:\temp"</span><span class="operator">,</span><span class="space"> </span><span class="macro">@DesktopDir</span><span class="operator">,</span><span class="space"> </span><span class="var">$FOF_WANTNUKEWARNING</span><span class="operator">)</span>
<br /><br />
<span class="comment">;Silently copy 2 different files to a directory.</span><br />
<span class="method">_FileCopyDlg</span><span class="operator">(</span><span class="string">"D:\temp\myfile1.txt"</span><span class="space"> </span><span class="S10">&amp;</span><span class="space"> </span><span class="macro">@LF</span><span class="space"> </span><span class="S10">&amp;</span><span class="space"> </span><span class="string">"C:\home\myfile2.txt"</span><span class="operator">,</span><span class="space"> </span><span class="macro">@DesktopDir</span><span class="operator">,</span><span class="space"> </span><span class="var">$FOF_SILENT</span><span class="operator">)</span>
</body>
</html>
